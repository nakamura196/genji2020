(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{530:function(t,e,n){"use strict";n.r(e);n(9),n(43),n(65),n(14),n(19),n(29),n(10),n(52),n(58);var r=n(20),o=n(142),l=n.n(o),c=n(175);function v(t,e){var n,r,o,l=[];for(n=0;n<=t.length;n++)l[n]=[n];for(r=0;r<=e.length;r++)l[0][r]=r;for(n=1;n<=t.length;n++)for(r=1;r<=e.length;r++)o=t.charCodeAt(n-1)==e.charCodeAt(r-1)?0:1,l[n][r]=Math.min(l[n-1][r]+1,l[n][r-1]+1,l[n-1][r-1]+o);return l[t.length][e.length]/Math.max(t.length,e.length)}var h={asyncData:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r,o,c,v,h,m,d,i,_,f,x;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.payload,r=t.app,!n){e.next=5;break}return e.abrupt("return",{result:n});case 5:return o=r.context.params.id,e.next=8,l.a.get("/nuxt.json");case 8:for(c=e.sent,v=c.data,h=v[o],m=h.arr,d=[],i=0;i<m.length;i++)_=m[i],(f=v[_.id]).score=_.score,d.push(f);return x={item:h,arr:d},e.abrupt("return",{result:x});case 16:case"end":return e.stop()}}),e)})))()},data:function(){return{baseUrl:"https://nakamura196.github.io/genji2020",prefix:"https://nakamura196.github.io/genji2020",select:"すべて",selectedText:"",isSignedIn:!1,checkbox:{}}},created:function(){var t=this;this.onAuthStateChanged();for(var e={},n=this.result.arr,i=0;i<n.length;i++)e[n[i].objectID]=[];var r=c.a.firestore().collection(this.result.item.objectID);r?r.get().then((function(n){n.forEach((function(t){e[t.id]=Array.isArray(t.data().values)?t.data().values:[t.data().values]})),t.checkbox=e})).catch((function(t){console.log("error : "+t)})):this.checkbox=e},computed:{url:function(){return this.baseUrl+"/item/"+this.$route.params.id},id:function(){return this.$route.params.id},title:function(){return null},items:function(){for(var t=this.result.arr,e=["すべて"],i=0;i<t.length;i++){var n=t[i].attribution;e.includes(n)||e.push(n)}return e},chips:function(){for(var t=this.result.arr,e=[],n=this.checkbox,i=0;i<t.length;i++){var r=t[i],o=r.objectID;n[o]&&n[o].length>0&&e.push(r.attribution)}return e}},watch:{selectedText:function(){for(var t=this.selectedText,e=this.result.arr,n=[],r=function(i){for(var r=e[i],o=r.label,map={},l=0;l<o.length;l++){var text=o[l],c=v(t,text);map[l]=c}var h=Object.keys(map).map((function(t){return{key:t,value:map[t]}}));h.sort((function(a,b){return a.value<b.value?-1:a.value>b.value?1:0})),r.highlight=h[0].key,n.push(r)},i=0;i<e.length;i++)r(i);this.result.arr=n}},methods:{onAuthStateChanged:function(){var t=this;c.a.auth().onAuthStateChanged((function(e){t.userName=e?e.displayName:null,t.userPic=e?e.photoURL:null,t.isSignedIn=!!e}))},getIframeUrl:function(){var t=this.result.item;return t.manifest?this.baseUrl+"/curation/?manifest="+t.manifest+"&canvas="+encodeURIComponent(t.canvas):this.baseUrl+"/curation/?curation="+t.curation+"&pos="+t.pos},selected:function(){this.selectedText=window.getSelection().toString()},getCurationUrl:function(){var t=this.result.item;return t.curation?"http://codh.rois.ac.jp/software/iiif-curation-viewer/demo/?curation="+t.curation+"&pos="+t.pos+"&mode=annotation":"http://codh.rois.ac.jp/software/iiif-curation-viewer/demo/?manifest="+t.manifest+"&canvas="+t.canvas},aaa:function(t){console.log(t)},update2:function(data){var t=data,e=this.checkbox[data],n=this.result.item.objectID;this.$store.dispatch("addNumber",{id:t,values:e,parent:n})},toArray2:function(map){var t=[];for(var e in map)t.push({key:e,text:map[e]});return console.log(t),t}},head:function(){var title=this.title;return{title:title,meta:[{hid:"og:title",property:"og:title",content:title},{hid:"og:type",property:"og:type",content:"article"},{hid:"og:url",property:"og:url",content:this.url},{hid:"og:image",property:"og:image",content:this.result.item.image},{hid:"twitter:card",name:"twitter:card",content:"summary_large_image"}]}}},m=n(106),d=n(146),_=n.n(d),f=n(297),x=n(211),C=n(97),k=n(532),w=n(474),y=n(518),I=n(461),V=n(520),j=n(521),S=n(522),T=n(523),D=n(209),P=n(176),U=n(137),$=n(101),A=n(213),R=n(519),E=n(526),L=n(63),N=n(524),O=n(525),component=Object(m.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-container",{staticClass:"py-5"},[n("iframe",{attrs:{src:t.getIframeUrl(),width:"100%",height:"400",allowfullscreen:"",frameborder:"0"}})]),t._v(" "),n("v-container",[n("div",{staticClass:"text-center"},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on;return[n("v-btn",t._g({staticClass:"mx-1",attrs:{icon:"",target:"_blank",href:t.getCurationUrl()}},r),[n("img",{attrs:{src:t.baseUrl+"/img/icons/icp-logo.svg",width:"30px"}})])]}}])},[t._v(" "),n("span",[t._v(t._s("IIIF Curation Viewer"))])]),t._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on;return[n("v-btn",t._g({staticClass:"mx-1",attrs:{icon:"",target:"_blank",href:"https://twitter.com/intent/tweet?url="+t.url}},r),[n("v-icon",[t._v("mdi-twitter")])],1)]}}])},[t._v(" "),n("span",[t._v(t._s("Twitter"))])]),t._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on;return[n("v-btn",t._g({staticClass:"mx-1",attrs:{icon:"",target:"_blank",href:"https://www.facebook.com/sharer/sharer.php?u="+t.url}},r),[n("v-icon",[t._v("mdi-facebook")])],1)]}}])},[t._v(" "),n("span",[t._v(t._s("Facebook"))])]),t._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on;return[n("v-btn",t._g({staticClass:"mx-1",attrs:{icon:"",target:"_blank",href:"http://getpocket.com/edit?url="+t.url}},r),[n("img",{staticStyle:{"font-size":"30px"},attrs:{src:"https://cultural.jp/img/icons/pocket.svg"}})])]}}])},[t._v(" "),n("span",[t._v(t._s("Pocket"))])]),t._v(" "),n("p",{staticClass:"my-4"},[n("v-btn",{staticClass:"ma-1",attrs:{to:t.localePath({name:"item-id",params:{id:("0000"+(Number(t.result.item.objectID)-1)).slice(-4)}})}},[n("v-icon",[t._v("mdi-chevron-left")])],1),t._v(" "),n("v-btn",{staticClass:"ma-1",attrs:{to:t.localePath({name:"item-id",params:{id:("0000"+(Number(t.result.item.objectID)+1)).slice(-4)}})}},[n("v-icon",[t._v("mdi-chevron-right")])],1)],1)],1),t._v(" "),n("dl",{staticClass:"row"},[n("dt",{staticClass:"col-sm-3 text-muted"},[n("b",[t._v("URL")])]),t._v(" "),n("dd",{staticClass:"col-sm-9",staticStyle:{"overflow-wrap":"break-word"}},[n("a",{attrs:{href:t.prefix+"/item/"+t.$route.params.id}},[t._v(t._s(t.prefix+"/item/"+t.$route.params.id))])])]),t._v(" "),n("dl",{staticClass:"row"},[n("dt",{staticClass:"col-sm-3 text-muted"},[n("b",[t._v(t._s(t.$t("title")))])]),t._v(" "),n("dd",{staticClass:"col-sm-9"},[t._v("\n            "+t._s(t.result.item.vol)+" "+t._s(t.result.item.work)+"\n            "+t._s(t.result.item.page)+t._s("国立国会図書館"==t.result.item.attribution?"ページ":"コマ目")+"\n          ")])]),t._v(" "),n("dl",{staticClass:"row"},[n("dt",{staticClass:"col-sm-3 text-muted"},[n("b",[t._v(t._s(t.$t("attribution")))])]),t._v(" "),n("dd",{staticClass:"col-sm-9"},[t._v("\n            "+t._s(t.result.item.attribution)+"\n          ")])]),t._v(" "),t._e(),t._v(" "),n("v-expansion-panels",{attrs:{tile:"",value:"国立国会図書館"==t.result.item.attribution?0:1}},[n("v-expansion-panel",{staticClass:"my-4"},[n("v-expansion-panel-header",[t._v("\n                  "+t._s("国立国会図書館"==t.result.item.attribution?"テキスト":"OCRテキスト")+"\n                ")]),t._v(" "),n("v-expansion-panel-content",[n("p",{domProps:{innerHTML:t._s(t.result.item.text.split("\n").join("<b> / </b>"))},on:{blur:t.selected,keyup:t.selected,click:t.selected,select:t.selected}})])],1)],1),t._v(" "),t.chips.length>0&&t.isSignedIn?[n("dl",{staticClass:"row"},[n("dt",{staticClass:"col-sm-3 text-muted"},[n("b",[t._v("番号付与済み")])]),t._v(" "),n("dd",{staticClass:"col-sm-9"},t._l(t.chips,(function(e,r){return n("v-chip",{key:"chip_"+r,staticClass:"mx-2"},[t._v("\n    "+t._s(e)+"\n  ")])})),1)])]:t._e(),t._v(" "),n("v-sheet",{staticClass:"pa-4 my-4",attrs:{color:"grey lighten-3"}},[n("v-row",{attrs:{dense:""}},[n("v-col",{attrs:{cols:"12",sm:3}},[n("h3",[t._v("類似コマ")])]),t._v(" "),n("v-col",{attrs:{cols:"12",sm:9}},[n("v-select",{attrs:{items:t.items,label:t.$t("attribution")},model:{value:t.select,callback:function(e){t.select=e},expression:"select"}})],1)],1)],1),t._v(" "),t._l(t.result.arr,(function(e,r){return["すべて"==t.select||e.attribution==t.select?n("v-card",{key:r,staticClass:"mb-5",attrs:{flat:"",outlined:""}},[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"3"}},[n("nuxt-link",{attrs:{to:t.localePath({name:"item-id",params:{id:e.objectID}})}},[n("v-img",{staticStyle:{height:"150px"},attrs:{src:e.image,contain:"",width:"100%"}})],1),t._v(" "),n("v-card-text",[n("div",{staticClass:"text-center"},[n("nuxt-link",{staticClass:"mr-2",attrs:{to:t.localePath({name:"item-id",params:{id:e.objectID}})}},[n("h3",[t._v(t._s(e.vol)+" "+t._s(e.work)+" "+t._s(e.page)+t._s("国立国会図書館"==e.attribution?"ページ":"コマ目"))])]),t._v(" "),n("p",[t._v("\n              "+t._s(e.attribution)+"\n            ")]),t._v(" "),n("v-progress-linear",{attrs:{value:100*e.score,height:"25"}},[t._v("\n          類似度: "),n("strong",[t._v(t._s(Math.ceil(100*e.score))+"%")])])],1),t._v(" "),""!=t.selectedText?[n("p",{staticClass:"mt-4"},[n("b",[t._v("選択済みテキスト：")]),t._v(t._s(t.selectedText))])]:t._e(),t._v(" "),t.isSignedIn?n("p",{staticClass:"mt-4"},[n("v-btn",{attrs:{color:"primary"},on:{click:function(n){return t.update2(e.objectID)}}},[t._v(t._s(t.$t("update")))])],1):t._e()],2)],1),t._v(" "),n("v-col",{attrs:{cols:"12",sm:"9"}},[t.isSignedIn&&"国立国会図書館"==t.result.item.attribution?[n("v-virtual-scroll",{attrs:{items:e.label,height:"500","item-height":"30"},scopedSlots:t._u([{key:"default",fn:function(r){var text=r.item,o=r.index;return[n("v-list-item",{key:o},[n("v-list-item-content",[n("v-checkbox",{staticClass:"my-0 py-0",attrs:{value:o,dense:""},model:{value:t.checkbox[e.objectID],callback:function(n){t.$set(t.checkbox,e.objectID,n)},expression:"checkbox[item.objectID]"}},[n("template",{slot:"label"},[o==e.highlight&&""!=t.selectedText?n("span",{staticClass:"background-color : yellow lighten-3"},[t._v("\n                  "+t._s(text)+"\n                ")]):n("span",[t._v("\n                  "+t._s(text)+"\n                ")])])],2)],1)],1)]}}],null,!0)})]:[n("v-card-text",[n("v-expansion-panels",{attrs:{tile:"",value:"国立国会図書館"==e.attribution?0:1}},[n("v-expansion-panel",[n("v-expansion-panel-header",[t._v("\n                    "+t._s("国立国会図書館"==e.attribution?"テキスト":"OCRテキスト")+"\n                  ")]),t._v(" "),n("v-expansion-panel-content",[n("p",[t._l(e.label,(function(text,r){return[r==e.highlight&&""!=t.selectedText?n("span",{staticClass:"background-color : yellow lighten-3"},[t._v("\n                          "+t._s(text)+"\n                        ")]):n("span",[t._v("\n                          "+t._s(text)+"\n                        ")]),t._v(" "),r!=e.label.length-1?n("b",[t._v(" / ")]):t._e()]}))],2),t._v(" "),""!=t.selectedText?[n("b",[t._v("選択済みテキスト：")]),t._v(t._s(t.selectedText))]:t._e()],2)],1)],1)],1)]],2)],1)],1):t._e()]}))],2)],1)}),[],!1,null,null,null);e.default=component.exports;_()(component,{VBtn:f.a,VCard:x.a,VCardText:C.b,VCheckbox:k.a,VChip:w.a,VCol:y.a,VContainer:I.a,VExpansionPanel:V.a,VExpansionPanelContent:j.a,VExpansionPanelHeader:S.a,VExpansionPanels:T.a,VIcon:D.a,VImg:P.a,VListItem:U.a,VListItemContent:$.a,VProgressLinear:A.a,VRow:R.a,VSelect:E.a,VSheet:L.a,VTooltip:N.a,VVirtualScroll:O.a})}}]);