(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{494:function(t,e,r){var content=r(495);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(19).default)("dc0628f2",content,!0,{sourceMap:!1})},495:function(t,e,r){var o=r(18)(!1);o.push([t.i,".v-tooltip{display:none}.v-tooltip--attached{display:inline}.v-tooltip__content{background:rgba(97,97,97,.9);color:#fff;border-radius:4px;font-size:14px;line-height:22px;display:inline-block;padding:5px 16px;position:absolute;text-transform:none;width:auto;opacity:1;pointer-events:none}.v-tooltip__content--fixed{position:fixed}.v-tooltip__content[class*=-active]{transition-timing-function:cubic-bezier(0,0,.2,1)}.v-tooltip__content[class*=enter-active]{transition-duration:.15s}.v-tooltip__content[class*=leave-active]{transition-duration:75ms}",""]),t.exports=o},499:function(t,e,r){"use strict";r(14);var o=r(4),n=(r(494),r(100)),l=r(35),c=r(140),d=r(104),h=r(141),v=r(179),m=r(43),f=r(2),_=r(10),y=r(9);e.a=Object(y.a)(l.a,c.a,d.a,h.a,v.a,m.a).extend({name:"v-tooltip",props:{closeDelay:{type:[Number,String],default:0},disabled:Boolean,fixed:{type:Boolean,default:!0},openDelay:{type:[Number,String],default:0},openOnHover:{type:Boolean,default:!0},tag:{type:String,default:"span"},transition:String},data:function(){return{calculatedMinWidth:0,closeDependents:!1}},computed:{calculatedLeft:function(){var t=this.dimensions,e=t.activator,content=t.content,r=!(this.bottom||this.left||this.top||this.right),o=!1!==this.attach?e.offsetLeft:e.left,n=0;return this.top||this.bottom||r?n=o+e.width/2-content.width/2:(this.left||this.right)&&(n=o+(this.right?e.width:-content.width)+(this.right?10:-10)),this.nudgeLeft&&(n-=parseInt(this.nudgeLeft)),this.nudgeRight&&(n+=parseInt(this.nudgeRight)),"".concat(this.calcXOverflow(n,this.dimensions.content.width),"px")},calculatedTop:function(){var t=this.dimensions,e=t.activator,content=t.content,r=!1!==this.attach?e.offsetTop:e.top,o=0;return this.top||this.bottom?o=r+(this.bottom?e.height:-content.height)+(this.bottom?10:-10):(this.left||this.right)&&(o=r+e.height/2-content.height/2),this.nudgeTop&&(o-=parseInt(this.nudgeTop)),this.nudgeBottom&&(o+=parseInt(this.nudgeBottom)),"".concat(this.calcYOverflow(o+this.pageYOffset),"px")},classes:function(){return{"v-tooltip--top":this.top,"v-tooltip--right":this.right,"v-tooltip--bottom":this.bottom,"v-tooltip--left":this.left,"v-tooltip--attached":""===this.attach||!0===this.attach||"attach"===this.attach}},computedTransition:function(){return this.transition?this.transition:this.isActive?"scale-transition":"fade-transition"},offsetY:function(){return this.top||this.bottom},offsetX:function(){return this.left||this.right},styles:function(){return{left:this.calculatedLeft,maxWidth:Object(f.f)(this.maxWidth),minWidth:Object(f.f)(this.minWidth),opacity:this.isActive?.9:0,top:this.calculatedTop,zIndex:this.zIndex||this.activeZIndex}}},beforeMount:function(){var t=this;this.$nextTick((function(){t.value&&t.callActivate()}))},mounted:function(){"v-slot"===Object(f.o)(this,"activator",!0)&&Object(_.b)("v-tooltip's activator slot must be bound, try '<template #activator=\"data\"><v-btn v-on=\"data.on>'",this)},methods:{activate:function(){this.updateDimensions(),requestAnimationFrame(this.startTransition)},deactivate:function(){this.runDelay("close")},genActivatorListeners:function(){var t=this,e=n.a.options.methods.genActivatorListeners.call(this);return e.focus=function(e){t.getActivator(e),t.runDelay("open")},e.blur=function(e){t.getActivator(e),t.runDelay("close")},e.keydown=function(e){e.keyCode===f.r.esc&&(t.getActivator(e),t.runDelay("close"))},e},genActivatorAttributes:function(){return{"aria-haspopup":!0,"aria-expanded":String(this.isActive)}},genTransition:function(){var content=this.genContent();return this.computedTransition?this.$createElement("transition",{props:{name:this.computedTransition}},[content]):content},genContent:function(){var t;return this.$createElement("div",this.setBackgroundColor(this.color,{staticClass:"v-tooltip__content",class:(t={},Object(o.a)(t,this.contentClass,!0),Object(o.a)(t,"menuable__content__active",this.isActive),Object(o.a)(t,"v-tooltip__content--fixed",this.activatorFixed),t),style:this.styles,attrs:this.getScopeIdAttrs(),directives:[{name:"show",value:this.isContentActive}],ref:"content"}),this.getContentSlot())}},render:function(t){var e=this;return t(this.tag,{staticClass:"v-tooltip",class:this.classes},[this.showLazyContent((function(){return[e.genTransition()]})),this.genActivator()])}})},503:function(t,e,r){var content=r(504);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(19).default)("b1bed018",content,!0,{sourceMap:!1})},504:function(t,e,r){var o=r(18)(!1);o.push([t.i,".theme--light.v-breadcrumbs .v-breadcrumbs__divider,.theme--light.v-breadcrumbs .v-breadcrumbs__item--disabled{color:rgba(0,0,0,.38)}.theme--dark.v-breadcrumbs .v-breadcrumbs__divider,.theme--dark.v-breadcrumbs .v-breadcrumbs__item--disabled{color:hsla(0,0%,100%,.5)}.v-breadcrumbs{align-items:center;display:flex;flex-wrap:wrap;flex:0 1 auto;list-style-type:none;margin:0;padding:18px 12px}.v-breadcrumbs li{align-items:center;display:inline-flex;font-size:14px}.v-breadcrumbs li .v-icon{font-size:16px}.v-breadcrumbs li:nth-child(2n){padding:0 12px}.v-breadcrumbs__item{align-items:center;display:inline-flex;text-decoration:none;transition:.3s cubic-bezier(.25,.8,.5,1)}.v-breadcrumbs__item--disabled{pointer-events:none}.v-breadcrumbs--large li,.v-breadcrumbs--large li .v-icon{font-size:16px}",""]),t.exports=o},531:function(t,e,r){var content=r(582);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(19).default)("1dee1762",content,!0,{sourceMap:!1})},547:function(t,e,r){"use strict";r(82);var o=r(4),n=(r(503),r(77)),l=r(9);function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function d(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var h=Object(l.a)(n.a).extend({name:"v-breadcrumbs-item",props:{activeClass:{type:String,default:"v-breadcrumbs__item--disabled"},ripple:{type:[Boolean,Object],default:!1}},computed:{classes:function(){return Object(o.a)({"v-breadcrumbs__item":!0},this.activeClass,this.disabled)}},render:function(t){var e=this.generateRouteLink(),r=e.tag,data=e.data;return t("li",[t(r,d(d({},data),{},{attrs:d(d({},data.attrs),{},{"aria-current":this.isActive&&this.isLink?"page":void 0})}),this.$slots.default)])}}),v=r(2),m=Object(v.g)("v-breadcrumbs__divider","li"),f=r(30);function _(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}e.a=Object(l.a)(f.a).extend({name:"v-breadcrumbs",props:{divider:{type:String,default:"/"},items:{type:Array,default:function(){return[]}},large:Boolean},computed:{classes:function(){return function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?_(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):_(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({"v-breadcrumbs--large":this.large},this.themeClasses)}},methods:{genDivider:function(){return this.$createElement(m,this.$slots.divider?this.$slots.divider:this.divider)},genItems:function(){for(var t=[],e=!!this.$scopedSlots.item,r=[],i=0;i<this.items.length;i++){var o=this.items[i];r.push(o.text),e?t.push(this.$scopedSlots.item({item:o})):t.push(this.$createElement(h,{key:r.join("."),props:o},[o.text])),i<this.items.length-1&&t.push(this.genDivider())}return t}},render:function(t){var e=this.$slots.default||this.genItems();return t("ul",{staticClass:"v-breadcrumbs",class:this.classes},e)}})},581:function(t,e,r){"use strict";r(531)},582:function(t,e,r){var o=r(18)(!1);o.push([t.i,".horizontal-list{overflow-x:auto;white-space:nowrap;-webkit-overflow-scrolling:touch;padding-left:0!important;padding-right:0}.item{display:inline-block;margin-right:16px}.scroll{overflow-y:auto}.vertical{-ms-writing-mode:tb-rl;writing-mode:vertical-rl}",""]),t.exports=o},583:function(t,e,r){var content=r(584);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(19).default)("7c06aa28",content,!0,{sourceMap:!1})},584:function(t,e,r){var o=r(18)(!1);o.push([t.i,".theme--light.v-data-table{background-color:#fff;color:rgba(0,0,0,.87)}.theme--light.v-data-table .v-data-table__divider{border-right:thin solid rgba(0,0,0,.12)}.theme--light.v-data-table.v-data-table--fixed-header thead th{background:#fff;box-shadow:inset 0 -1px 0 rgba(0,0,0,.12)}.theme--light.v-data-table>.v-data-table__wrapper>table>thead>tr>th{color:rgba(0,0,0,.6)}.theme--light.v-data-table>.v-data-table__wrapper>table>tbody>tr:not(:last-child)>td:last-child,.theme--light.v-data-table>.v-data-table__wrapper>table>tbody>tr:not(:last-child)>td:not(.v-data-table__mobile-row),.theme--light.v-data-table>.v-data-table__wrapper>table>tbody>tr:not(:last-child)>th:last-child,.theme--light.v-data-table>.v-data-table__wrapper>table>tbody>tr:not(:last-child)>th:not(.v-data-table__mobile-row),.theme--light.v-data-table>.v-data-table__wrapper>table>thead>tr:last-child>th{border-bottom:thin solid rgba(0,0,0,.12)}.theme--light.v-data-table>.v-data-table__wrapper>table>tbody>tr.active{background:#f5f5f5}.theme--light.v-data-table>.v-data-table__wrapper>table>tbody>tr:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper){background:#eee}.theme--dark.v-data-table{background-color:#1e1e1e;color:#fff}.theme--dark.v-data-table .v-data-table__divider{border-right:thin solid hsla(0,0%,100%,.12)}.theme--dark.v-data-table.v-data-table--fixed-header thead th{background:#1e1e1e;box-shadow:inset 0 -1px 0 hsla(0,0%,100%,.12)}.theme--dark.v-data-table>.v-data-table__wrapper>table>thead>tr>th{color:hsla(0,0%,100%,.7)}.theme--dark.v-data-table>.v-data-table__wrapper>table>tbody>tr:not(:last-child)>td:last-child,.theme--dark.v-data-table>.v-data-table__wrapper>table>tbody>tr:not(:last-child)>td:not(.v-data-table__mobile-row),.theme--dark.v-data-table>.v-data-table__wrapper>table>tbody>tr:not(:last-child)>th:last-child,.theme--dark.v-data-table>.v-data-table__wrapper>table>tbody>tr:not(:last-child)>th:not(.v-data-table__mobile-row),.theme--dark.v-data-table>.v-data-table__wrapper>table>thead>tr:last-child>th{border-bottom:thin solid hsla(0,0%,100%,.12)}.theme--dark.v-data-table>.v-data-table__wrapper>table>tbody>tr.active{background:#505050}.theme--dark.v-data-table>.v-data-table__wrapper>table>tbody>tr:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper){background:#616161}.v-data-table{line-height:1.5;max-width:100%}.v-data-table>.v-data-table__wrapper>table{width:100%;border-spacing:0}.v-data-table>.v-data-table__wrapper>table>tbody>tr>td,.v-data-table>.v-data-table__wrapper>table>tbody>tr>th,.v-data-table>.v-data-table__wrapper>table>tfoot>tr>td,.v-data-table>.v-data-table__wrapper>table>tfoot>tr>th,.v-data-table>.v-data-table__wrapper>table>thead>tr>td,.v-data-table>.v-data-table__wrapper>table>thead>tr>th{padding:0 16px;transition:height .2s cubic-bezier(.4,0,.6,1)}.v-data-table>.v-data-table__wrapper>table>tbody>tr>th,.v-data-table>.v-data-table__wrapper>table>tfoot>tr>th,.v-data-table>.v-data-table__wrapper>table>thead>tr>th{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font-size:.75rem;height:48px}.v-application--is-ltr .v-data-table>.v-data-table__wrapper>table>tbody>tr>th,.v-application--is-ltr .v-data-table>.v-data-table__wrapper>table>tfoot>tr>th,.v-application--is-ltr .v-data-table>.v-data-table__wrapper>table>thead>tr>th{text-align:left}.v-application--is-rtl .v-data-table>.v-data-table__wrapper>table>tbody>tr>th,.v-application--is-rtl .v-data-table>.v-data-table__wrapper>table>tfoot>tr>th,.v-application--is-rtl .v-data-table>.v-data-table__wrapper>table>thead>tr>th{text-align:right}.v-data-table>.v-data-table__wrapper>table>tbody>tr>td,.v-data-table>.v-data-table__wrapper>table>tfoot>tr>td,.v-data-table>.v-data-table__wrapper>table>thead>tr>td{font-size:.875rem;height:48px}.v-data-table__wrapper{overflow-x:auto;overflow-y:hidden}.v-data-table__progress{height:auto!important}.v-data-table__progress th{height:auto!important;border:none!important;padding:0;position:relative}.v-data-table--dense>.v-data-table__wrapper>table>tbody>tr>td,.v-data-table--dense>.v-data-table__wrapper>table>tbody>tr>th,.v-data-table--dense>.v-data-table__wrapper>table>tfoot>tr>td,.v-data-table--dense>.v-data-table__wrapper>table>tfoot>tr>th,.v-data-table--dense>.v-data-table__wrapper>table>thead>tr>td,.v-data-table--dense>.v-data-table__wrapper>table>thead>tr>th{height:32px}.v-data-table--has-top>.v-data-table__wrapper>table>tbody>tr:first-child:hover>td:first-child{border-top-left-radius:0}.v-data-table--has-top>.v-data-table__wrapper>table>tbody>tr:first-child:hover>td:last-child{border-top-right-radius:0}.v-data-table--has-bottom>.v-data-table__wrapper>table>tbody>tr:last-child:hover>td:first-child{border-bottom-left-radius:0}.v-data-table--has-bottom>.v-data-table__wrapper>table>tbody>tr:last-child:hover>td:last-child{border-bottom-right-radius:0}.v-data-table--fixed-header>.v-data-table__wrapper,.v-data-table--fixed-height .v-data-table__wrapper{overflow-y:auto}.v-data-table--fixed-header>.v-data-table__wrapper>table>thead>tr>th{border-bottom:0!important;position:-webkit-sticky;position:sticky;top:0;z-index:2}.v-data-table--fixed-header>.v-data-table__wrapper>table>thead>tr:nth-child(2)>th{top:48px}.v-application--is-ltr .v-data-table--fixed-header .v-data-footer{margin-right:17px}.v-application--is-rtl .v-data-table--fixed-header .v-data-footer{margin-left:17px}.v-data-table--fixed-header.v-data-table--dense>.v-data-table__wrapper>table>thead>tr:nth-child(2)>th{top:32px}",""]),t.exports=o},627:function(t,e,r){"use strict";r.r(e);r(48),r(69),r(21),r(80),r(70),r(71);var o=r(4),n=(r(53),r(15)),l=r(130),c=r.n(l),d=r(163),h=d.a.firestore.FieldValue,v=d.a.firestore();function m(t,e){var r,o,n,l=[];for(r=0;r<=t.length;r++)l[r]=[r];for(o=0;o<=e.length;o++)l[0][o]=o;for(r=1;r<=t.length;r++)for(o=1;o<=e.length;o++)n=t.charCodeAt(r-1)===e.charCodeAt(o-1)?0:1,l[r][o]=Math.min(l[r-1][o]+1,l[r][o-1]+1,l[r-1][o-1]+n);return l[t.length][e.length]/Math.max(t.length,e.length)}var f={asyncData:function(t){return Object(n.a)(regeneratorRuntime.mark((function e(){var r,o,n,l,d,h,v,i,m,f,_,y,x,w,k,I,j,O,C,D,S;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.payload,o=t.app,!r){e.next=5;break}return e.abrupt("return",{result:r});case 5:return n=o.context.params.id,l={},e.next=9,c.a.get(o.context.env.BASE_URL+"/nuxt.json");case 9:for(h in(d=e.sent).data)l[h]=d.data[h];v=["kyoto01","kyoto02","ndl02","ndl03","ndl04","nijl","utokyo"],i=0;case 13:if(!(i<v.length)){e.next=22;break}return m=v[i],e.next=17,c.a.get(o.context.env.BASE_URL+"/data/json/"+m+".json");case 17:for(_ in(f=e.sent).data)l[_]=f.data[_];case 19:i++,e.next=13;break;case 22:for(k in y=l[n],x=y.arr,w={},x){for(I=[],j=x[k],O=0;O<j.length;O++)C=j[O],(D=l[C.id]).score=C.score,I.push(D);w[k]=I}return S={item:y,arr:w},e.abrupt("return",{result:S,nuxt:l});case 28:case"end":return e.stop()}}),e)})))()},data:function(){return{baseUrl:"https://nakamura196.github.io/genji2020",prefix:"https://nakamura196.github.io/genji2020",select:"すべて",selectedText:"",isSignedIn:!1,checkbox:{},like:!0,dialog:!1,rItemId:"",lItemId:"",lText:"",highlight_line_index:-1,documents:[],documentIds:[],uid:"",login:!1,width:window.innerWidth}},head:function(){var title=this.title;return{title:title,meta:[{hid:"og:title",property:"og:title",content:title},{hid:"og:type",property:"og:type",content:"article"},{hid:"og:url",property:"og:url",content:this.url},{hid:"og:image",property:"og:image",content:this.result.item.image},{hid:"twitter:card",name:"twitter:card",content:"summary_large_image"}]}},computed:{url:function(){return this.baseUrl+"/item/"+this.$route.params.id},id:function(){return this.$route.params.id},title:function(){var t=this.item;return t.vol_str+" "+t.page+t.type},bh:function(){return[{text:this.$t("top"),disabled:!1,to:this.localePath({name:"index"}),exact:!0},Object(o.a)({text:this.$t("search"),disabled:!1,to:this.localePath({name:"search",query:{"genji[sortBy]":"genji_page_asc"}})},"text",this.$t("search")),{text:this.title}]},items:function(){var t=this.result.arr,e=["すべて"];for(var r in t)t[r].length>0&&e.push(r);return e},rItem:function(){var t=this.rItemId;return this.nuxt[t]||{}},lItem:function(){var t=this.lItemId;return this.selectedText="",this.nuxt[t]||{}},item:function(){return this.result.item}},watch:{selectedText:function(){this.update_highlight()},rItem:function(){this.update_highlight()}},created:function(){var t=this;d.a.firestore().collection("kouis").doc(this.id).collection("documents").onSnapshot((function(e){var r={},o=[];e.forEach(function(){var t=Object(n.a)(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.data().likedUsers||[],r[e.id]=n,o.push(e.id);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.documents=r,t.documentIds=o}),(function(t){console.error("GET_REALTIME_LIST",t)})),this.onAuthStateChanged();for(var e={},r=this.result.arr,i=0;i<r.length;i++)e[r[i].objectID]=[];var o=d.a.firestore().collection(this.result.item.objectID);o?o.get().then((function(r){r.forEach((function(t){e[t.id]=Array.isArray(t.data().values)?t.data().values:[t.data().values]})),t.checkbox=e})).catch((function(t){console.log("error : "+t)})):this.checkbox=e},methods:{labelConverter:function(t){return{NDL02:"伝嵯峨本（国会図書館所蔵）",NDL03:"近世前期写本（国会図書館所蔵）",NDL04:"元和9年古活字版（国会図書館所蔵）","京大本01":"平松家本（京都大学所蔵）","京大本02":"中院文庫本（京都大学所蔵）","東大本":"東京大学本（東京大学総合図書館所蔵）","湖月抄（国文研所蔵）":"『湖月抄』鵜飼文庫（国文研所蔵）"}[t]},update_highlight:function(){var t=this.selectedText,e=this.rItem;if(0!=Object.keys(e).length){for(var r=e.label,map={},o=0;o<r.length;o++){var n=m(t,r[o]);map[o]=n}var l=Object.keys(map).map((function(t){return{key:t,value:map[t]}}));l.sort((function(a,b){return a.value<b.value?-1:a.value>b.value?1:0}));var c=l[0].key;this.highlight_line_index=c}else this.highlight_line_index=-1},onAuthStateChanged:function(){var t=this;d.a.auth().onAuthStateChanged((function(e){t.uid=e.uid||"",t.login=!!e,t.userName=e?e.displayName:null,t.userPic=e?e.photoURL:null,t.isSignedIn=!!e}))},getIframeUrl:function(t){return t.manifest?this.baseUrl+"/curation/?manifest="+t.manifest+"&canvas="+encodeURIComponent(t.canvas):this.baseUrl+"/curation/?curation="+t.curation+"&pos="+t.pos},selected:function(){this.selectedText=window.getSelection().toString()},getCurationUrl:function(){var t=this.result.item;return t.curation?"http://codh.rois.ac.jp/software/iiif-curation-viewer/demo/?curation="+t.curation+"&pos="+t.pos+"&mode=annotation":"http://codh.rois.ac.jp/software/iiif-curation-viewer/demo/?manifest="+t.manifest+"&canvas="+t.canvas},toArray2:function(map){var t=[];for(var e in map)t.push({key:e,text:map[e]});return console.log(t),t},checkLike:function(){return this.like},good:function(t,e){var r=this;return Object(n.a)(regeneratorRuntime.mark((function o(){var n,l,c,m,f,_,y;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,d.a.firestore().collection("kouis").doc(r.id).get();case 2:if(n=o.sent,l=n.ref,n.exists){o.next=7;break}return o.next=7,l.set({id:r.id,createTime:h.serverTimestamp(),updateTime:h.serverTimestamp()});case 7:return o.next=9,d.a.firestore().collection("kouis").doc(r.id).collection("documents").doc(t).get();case 9:if(c=o.sent,m=c.ref,c.exists){o.next=14;break}return o.next=14,m.set({id:t,createTime:h.serverTimestamp(),updateTime:h.serverTimestamp(),likedUsers:[]});case 14:return f=v.batch(),o.next=17,d.a.firestore().collection("users").doc(r.uid).get();case 17:return _=o.sent,y=_.ref,e?(f.update(v.doc(m.path),{updateTime:h.serverTimestamp(),likedUsers:d.a.firestore.FieldValue.arrayUnion(y.id)}),f.set(v.doc(y.path).collection("likedDocs").doc(m.id),{id:m.id,postRef:m,createTime:h.serverTimestamp()}),f.update(y,{likeDocCount:h.increment(1)})):(f.update(v.doc(m.path),{updateTime:h.serverTimestamp(),likedUsers:d.a.firestore.FieldValue.arrayRemove(y.id)}),f.delete(v.doc(y.path).collection("likedDocs").doc(m.id)),f.update(y,{likeDocCount:h.increment(-1)})),o.next=22,f.commit();case 22:case"end":return o.stop()}}),o)})))()}}},_=(r(581),r(103)),y=r(139),x=r.n(y),w=r(547),k=r(303),I=r(215),j=r(96),O=r(514),C=r(485),D=r(487),S=r(213),T=r(175),P=r(217),A=r(515),$=r(625),L=r(58),V=(r(14),r(583),r(2)),E=r(30),U=r(9);function R(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}var z=Object(U.a)(E.a).extend({name:"v-simple-table",props:{dense:Boolean,fixedHeader:Boolean,height:[Number,String]},computed:{classes:function(){return function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?R(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):R(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({"v-data-table--dense":this.dense,"v-data-table--fixed-height":!!this.height&&!this.fixedHeader,"v-data-table--fixed-header":this.fixedHeader,"v-data-table--has-top":!!this.$slots.top,"v-data-table--has-bottom":!!this.$slots.bottom},this.themeClasses)}},methods:{genWrapper:function(){return this.$slots.wrapper||this.$createElement("div",{staticClass:"v-data-table__wrapper",style:{height:Object(V.f)(this.height)}},[this.$createElement("table",this.$slots.default)])}},render:function(t){return t("div",{staticClass:"v-data-table",class:this.classes},[this.$slots.top,this.genWrapper(),this.$slots.bottom])}}),B=r(490),M=r(499),component=Object(_.a)(f,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("v-sheet",{attrs:{color:"grey lighten-2"}},[r("v-container",{staticClass:"py-4",attrs:{fluid:""}},[r("v-breadcrumbs",{staticClass:"py-0",attrs:{items:t.bh},scopedSlots:t._u([{key:"divider",fn:function(){return[r("v-icon",[t._v("mdi-chevron-right")])]},proxy:!0}])})],1)],1),t._v(" "),r("p",{staticClass:"text-center mb-5 mt-2"},[r("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[t.item.next?r("v-btn",t._g({staticClass:"ma-1",attrs:{fab:"",dark:"",small:"",to:t.localePath({name:"item-id",params:{id:t.item.next}})}},o),[r("v-icon",[t._v("mdi-chevron-left")])],1):t._e()]}}])},[t._v(" "),r("span",[t._v(t._s("次の"+t.item.type+"へ"))])]),t._v(" "),r("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[t.item.prev?r("v-btn",t._g({staticClass:"ma-1",attrs:{fab:"",dark:"",small:"",to:t.localePath({name:"item-id",params:{id:t.item.prev}})}},o),[r("v-icon",[t._v("mdi-chevron-right")])],1):t._e()]}}])},[t._v(" "),r("span",[t._v(t._s("前の"+t.item.type+"へ"))])])],1),t._v(" "),r("v-sheet",{attrs:{color:"grey lighten-3 mt-5 px-5"}},[r("v-row",[r("v-col",{attrs:{cols:"12",sm:"6"}},[r("v-card",{staticClass:"my-5 scroll vertical",style:"height: 400px; width: "+t.width/2+"px",attrs:{flat:""}},[r("div",{staticClass:"pa-4 px-5"},[r("span",{domProps:{innerHTML:t._s(t.item.text.split("\n").join("<br/>"))},on:{select:t.selected,blur:t.selected,keyup:t.selected,click:t.selected}})])])],1),t._v(" "),r("v-col",{attrs:{cols:"12",sm:"6"}},[r("iframe",{staticClass:"my-5",attrs:{src:t.getIframeUrl(t.item),width:"100%",height:"400",allowfullscreen:"",frameborder:"0"}})])],1)],1),t._v(" "),r("v-container",{staticClass:"mt-5 py-5"},[r("h2",[t._v(t._s(t.title))]),t._v(" "),r("div",{staticClass:"text-center my-2"},[r("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[r("v-btn",t._g({staticClass:"mx-1",attrs:{icon:"",target:"_blank",href:t.getCurationUrl()}},o),[r("img",{attrs:{src:t.baseUrl+"/img/icons/icp-logo.svg",width:"30px"}})])]}}])},[t._v(" "),r("span",[t._v(t._s("IIIF Curation Viewer"))])]),t._v(" "),r("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[r("v-btn",t._g({staticClass:"mx-1",attrs:{icon:"",target:"_blank",href:"https://twitter.com/intent/tweet?url="+t.url}},o),[r("v-icon",[t._v("mdi-twitter")])],1)]}}])},[t._v(" "),r("span",[t._v(t._s("Twitter"))])]),t._v(" "),r("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[r("v-btn",t._g({staticClass:"mx-1",attrs:{icon:"",target:"_blank",href:"https://www.facebook.com/sharer/sharer.php?u="+t.url}},o),[r("v-icon",[t._v("mdi-facebook")])],1)]}}])},[t._v(" "),r("span",[t._v(t._s("Facebook"))])]),t._v(" "),r("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[r("v-btn",t._g({staticClass:"mx-1",attrs:{icon:"",target:"_blank",href:"http://getpocket.com/edit?url="+t.url}},o),[r("img",{staticStyle:{"font-size":"30px"},attrs:{src:"https://cultural.jp/img/icons/pocket.svg"}})])]}}])},[t._v(" "),r("span",[t._v(t._s("Pocket"))])])],1),t._v(" "),t._e()],1),t._v(" "),r("v-sheet",{staticClass:"pa-4 my-5",attrs:{color:"grey lighten-3"}},[r("v-container",[r("v-row",[r("v-col",{attrs:{cols:"12",sm:8}},[r("h3",[t._v("類似度の高い見開きページ")]),t._v(" "),r("p",{staticClass:"my-0"},[r("ul",[r("li",[t._v("\n                『校異源氏物語』のテキストデータと、くずし字OCR結果のテキストデータ間の編集距離を用いて、類似度の高い見開きページを表示しています。詳しくは、"),r("nuxt-link",{attrs:{to:t.localePath({name:"about"})}},[t._v("こちら")]),t._v("をご覧ください。\n              ")],1),t._v(" "),r("li",[t._v("\n                背景が黄色になっているものは、『校異源氏物語』の頁番号が既に付与されているページです。\n              ")])])])]),t._v(" "),r("v-col",{attrs:{cols:"12",sm:4}},[r("v-select",{attrs:{items:t.items,label:t.$t("target")},model:{value:t.select,callback:function(e){t.select=e},expression:"select"}})],1)],1)],1)],1),t._v(" "),r("v-container",[t._l(t.result.arr,(function(e,o){return["すべて"!=t.select&&o!=t.select||!t.items.includes(o)?t._e():r("div",{key:o},[r("h3",{staticClass:"mb-3 mt-5"},[t._v(t._s(t.labelConverter(o)))]),t._v(" "),r("ul",{staticClass:"horizontal-list"},t._l(e,(function(e,o){return r("li",{key:o,staticClass:"item"},[r("v-card",{key:o,staticClass:"mb-5",style:t.result.item.koui.includes(e.objectID)?"background-color : #FFF59D":"",attrs:{flat:"",outlined:""}},[r("a",{on:{click:function(r){t.rItemId=e.objectID,t.lItemId=t.id,t.dialog=!0}}},[r("v-img",{staticClass:"grey lighten-2",staticStyle:{height:"150px"},attrs:{src:e.image,contain:"",width:"100%"}})],1),t._v(" "),r("v-card-text",[r("a",{on:{click:function(r){t.rItemId=e.objectID,t.lItemId=t.id,t.dialog=!0}}},[r("b",[t._v(" "+t._s(e.vol_str)+" "+t._s(e.page)+t._s(e.type)+" ")])]),t._v(" "),r("div",{staticClass:"mt-3"},[r("v-progress-linear",{attrs:{value:100*e.score,height:"25"}},[t._v("\n                    類似度:\n                    "),r("strong",[t._v(t._s(Math.ceil(100*e.score))+"%")])])],1)]),t._v(" "),r("v-card-actions",[r("v-spacer"),t._v(" "),t.login?[t.documentIds.includes(e.objectID)?[r("v-btn",{attrs:{icon:"",color:t.documents[e.objectID].includes(t.uid)?"pink":""},on:{click:function(r){t.good(e.objectID,!t.documents[e.objectID].includes(t.uid))}}},[r("v-icon",{staticClass:"mr-1"},[t._v(t._s(t.documents[e.objectID].includes(t.uid)?"mdi-heart":"mdi-heart-outline"))]),t._v(t._s(t.documents[e.objectID].length>0?t.documents[e.objectID].length:"")+"\n                    ")],1)]:[r("v-btn",{attrs:{icon:""},on:{click:function(r){return t.good(e.objectID,!0)}}},[r("v-icon",{staticClass:"mr-1"},[t._v("mdi-heart-outline")])],1)]]:[r("div",{staticClass:"my-1"},[r("v-icon",{staticClass:"mr-1"},[t._v("mdi-heart-outline")]),t._v(t._s(t.documentIds.includes(e.objectID)?t.documents[e.objectID].length:"")+"\n                  ")],1)]],2)],1)],1)})),0)])]}))],2),t._v(" "),r("p",{staticClass:"my-10"}),t._v(" "),r("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[r("v-btn",{attrs:{fab:"",dark:"",fixed:"",top:"",right:"",small:""},on:{click:function(e){t.dialog=!1}}},[r("v-icon",[t._v("mdi-close")])],1),t._v(" "),r("v-card",[r("div",{staticClass:"pa-4"},[r("v-row",[r("v-col",[r("v-card",{attrs:{flat:"",outlined:""}},[r("iframe",{attrs:{src:t.getIframeUrl(t.lItem),width:"100%",height:"600",allowfullscreen:"",frameborder:"0"}}),t._v(" "),r("div",{staticClass:"pa-4"},[r("p",{staticClass:"my-2 text-center"},[t.lItem.next?r("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[r("v-btn",t._g({staticClass:"ma-1",attrs:{fab:"",dark:"",small:""},on:{click:function(e){t.lItemId=t.lItem.next}}},o),[r("v-icon",[t._v("mdi-chevron-left")])],1)]}}],null,!1,329006038)},[t._v(" "),r("span",[t._v(t._s("次の"+t.lItem.type+"へ"))])]):t._e(),t._v(" "),t.lItem.prev?r("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[r("v-btn",t._g({staticClass:"ma-1",attrs:{fab:"",dark:"",small:""},on:{click:function(e){t.lItemId=t.lItem.prev}}},o),[r("v-icon",[t._v("mdi-chevron-right")])],1)]}}],null,!1,2795115163)},[t._v(" "),r("span",[t._v(t._s("前の"+t.lItem.type+"へ"))])]):t._e()],1),t._v(" "),r("h2",[t._v("\n                  "+t._s(t.lItem.vol_str)+" "+t._s(t.lItem.page)+t._s(t.lItem.type)+"（"+t._s(t.lItem.target)+"）\n                ")]),t._v(" "),t.lItem.text?r("p",{staticClass:"mt-2",domProps:{innerHTML:t._s(t.lItem.text.split("\n").join("<b> / </b>"))},on:{select:t.selected,blur:t.selected,keyup:t.selected,click:t.selected}}):t._e()])])],1),t._v(" "),r("v-col",[r("v-card",{attrs:{flat:"",outlined:""}},[r("iframe",{attrs:{src:t.getIframeUrl(t.rItem),width:"100%",height:"600",allowfullscreen:"",frameborder:"0"}}),t._v(" "),r("div",{staticClass:"pa-4"},[r("p",{staticClass:"my-2 text-center"},[t.rItem.next?r("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[r("v-btn",t._g({staticClass:"ma-1",attrs:{fab:"",dark:"",small:""},on:{click:function(e){t.rItemId=t.rItem.next}}},o),[r("v-icon",[t._v("mdi-chevron-left")])],1)]}}],null,!1,3012904918)},[t._v(" "),r("span",[t._v(t._s("次の"+t.rItem.type+"へ"))])]):t._e(),t._v(" "),t.rItem.prev?r("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[r("v-btn",t._g({staticClass:"ma-1",attrs:{fab:"",dark:"",small:""},on:{click:function(e){t.rItemId=t.rItem.prev}}},o),[r("v-icon",[t._v("mdi-chevron-right")])],1)]}}],null,!1,3493560987)},[t._v(" "),r("span",[t._v(t._s("前の"+t.rItem.type+"へ"))])]):t._e()],1),t._v(" "),r("h2",[t._v("\n                  "+t._s(t.rItem.vol_str)+" "+t._s(t.rItem.page)+t._s(t.rItem.type)+"（"+t._s(t.labelConverter(t.rItem.target))+"）\n                ")]),t._v(" "),r("p",{staticClass:"mt-2"},[t._l(t.rItem.label,(function(text,e){return[e==t.highlight_line_index&&""!=t.selectedText?r("span",{key:e,staticClass:"background-color : yellow lighten-3"},[t._v("\n                      "+t._s(text)+"\n                    ")]):r("span",{key:e},[t._v("\n                      "+t._s(text)+"\n                    ")]),t._v(" "),e!=t.item.label.length-1?r("b",{key:"br-"+e},[t._v("\n                      /\n                    ")]):t._e()]}))],2)])])],1)],1),t._v(" "),r("div",{staticClass:"text-center my-10"})],1)])],1)],1)}),[],!1,null,null,null);e.default=component.exports;x()(component,{VBreadcrumbs:w.a,VBtn:k.a,VCard:I.a,VCardActions:j.a,VCardText:j.b,VCol:O.a,VContainer:C.a,VDialog:D.a,VIcon:S.a,VImg:T.a,VProgressLinear:P.a,VRow:A.a,VSelect:$.a,VSheet:L.a,VSimpleTable:z,VSpacer:B.a,VTooltip:M.a})}}]);